<%= stylesheet_link_tag  "schoolProfile" %>
<%= stylesheet_link_tag  "bootstrap.min" %>
<title>School Profile</title>

<div class="container-fluid schbckimg">
  <div class="content-agileits">
    <div class="left">
      <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
      <%= devise_error_messages! %>
      <form action="#" method="post" data-toggle="validator">
        <div class="row">
          <div class="col-md-12">
            <div class="form-group frmgrpcust">
              <label for="firstname" class="control-label">School Name:</label>
              <%= f.text_field :name, autofocus: true,class: "form-control",placeholder: "Name",value: resource.name %>
              <div class="help-block with-errors"></div>
            </div>
          </div>
        </div> 

        <div class="row">
          <div class="col-md-12">     
            <div class="form-group frmgrpcust">
              <label for="inputEmail" class="control-label">Email:</label>
              <%= f.email_field :email, autofocus: true,class: "form-control",placeholder: "Name",value: resource.email %>
              <div class="help-block with-errors"></div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">         
            <div class="form-group frmgrpcust">
              <label for="Phone" class="control-label">Phone:</label>
              <%= f.text_field :phone_no, autofocus: true,class: "form-control",placeholder: "Phone",value: resource.phone_no %>
              <div class="help-block with-errors"></div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">
            <div class="form-group frmgrpcust">
              <label for="Address" class="control-label">Address:</label>
              <%= f.text_area :address, autofocus: true,class: "form-control",placeholder: "Address" %>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-4">
            <div class="form-group frmgrpcust">
              <label for="Country" class="control-label">Country:</label>
                <%#= f.collection_select :country_id, Countr.order(:name), :id, :name, include_blank: true,class: "form-control" %>
                <%=select_tag :country_id, options_for_select(@countries.collect{|p| [p.name, p.id]}),prompt: "Select Country", class: "form-control"%>
              <div class="help-block with-errors"></div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group frmgrpcust">
              <label for="State" class="control-label">State:</label>
              <%#= f.grouped_collection_select :state_id, Countr.order(:name), :stat, :name, :id, :name, include_blank: true,class: "form-control" %>
              <%=select_tag :state_id, options_for_select(@states.collect{|p| [p.name, p.id]}),prompt: "Select State", class: "form-control" %>
              <div class="help-block with-errors"></div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group frmgrpcust">
              <label for="City" class="control-label">City:</label>
              <%=select_tag :city_id, options_for_select(@cities.collect{|p| [p.name, p.id]}),prompt: "Select City", class: "form-control" %>
              <%#= f.grouped_collection_select :city_id, Stat.order(:name), :city, :name, :id, :name, include_blank: true,class: "form-control" %>
              <div class="help-block with-errors"></div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group frmgrpcust">
              <label for="Class" class="control-label">Pincode:</label>
              <%= f.text_field :pincode, autofocus: true,class: "form-control",placeholder: "Pincode" %>
              <div class="help-block with-errors"></div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group frmgrpcust">
              <label for="Class" class="control-label">Specaliztion:</label>
              <%= f.text_field :qualification, autofocus: true,class: "form-control"%>
              <div class="help-block with-errors"></div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">
            <div class="form-group frmgrpcust">
              <label for="Address" class="control-label">Description:</label>
              <%= f.text_area :description,maxlength: 180, autofocus: true,class: "form-control",placeholder: "Description" %>
            </div>
          </div>
        </div>

        <div class="form-group frmgrpcust">
          <label for="file" class="control-label">Image:</label>
          <%= f.file_field :profile_image, autofocus: true,class: "form-control"%>
          <div class="help-block with-errors"></div>
        </div>

        <div class="form-group frmgrpcust">
          <label for="file" class="control">Cover Image:</label>
          <%= f.file_field :cover_image, autofocus: true,class: "form-control"%>
          <div class="help-block with-errors"></div>
        </div>


        <div class="form-inline row">
          <div class="col-sm-12 col-md-12 col-xs-12">
            <div class="form-group frmgrpcust col-sm-6 col-md-6  col-lg-6 agileits-w3layouts">
              <%= f.submit "Update", class: "btn btn-lg"%>
            </div>
            <div class="form-group frmgrpcust col-sm-6 col-md-6 col-lg-6 agileits-w3layouts">
              <button type="reset" class="btn btn-lg">reset</button>
            </div>
          </div>
        </div>
      </form>
    <% end %>
    </div>
    <div class="right">
      <div class="heading-text">
        <h1 class="student-profile">Edit School Profile</h1>
      </div>
    </div>
    <div class="clear"></div>
  </div>
</div>
<%= javascript_include_tag "jquery.min" %>
<%= javascript_include_tag "bootstrap.min" %>
<!-- <script type="text/javascript">
jQuery(function() {
  var states;
  $('#user_state_id').parent().hide();
  states = $('#user_state_id').html();
  console.log(states);
  return $('#user_country_id').change(function() {
    var country, escaped_country, options;
    country = $('#user_country_id :selected').text();
    escaped_country = country.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g, '\\$1');
    options = $(states).filter("optgroup[label=" + escaped_country + "]").html();
    console.log(options);
    if (options) {
      $('#user_state_id').html(options);
      return $('#user_state_id').parent().show();
    } else {
      $('#user_state_id').empty();
      return $('#user_state_id').parent().hide();
    }
  });
});
</script>
<script type="text/javascript">
jQuery(function() {
  var cities;
  $('#user_city_id').parent().hide();
  cities = $('#user_city_id').html();
  console.log(cities);
  return $('#user_state_id').change(function() {
    var state, escaped_state, options;
    state = $('#user_state_id :selected').text();
    escaped_state = state.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g, '\\$1');
    options = $(cities).filter("optgroup[label=" + escaped_state + "]").html();
    console.log(options);
    if (options) {
      $('#user_city_id').html(options);
      return $('#user_city_id').parent().show();
    } else {
      $('#user_city_id').empty();
      return $('#user_city_id').parent().hide();
    }
  });
});
</script> -->
<script type="text/javascript">
  $(document).on("change", "#country_id", function(){
    var country = $(this).val();
    $.ajax({
      url: "/users/edit",
      method: "GET",
      dataType: "json",
      data: {country: country},
      error: function (xhr, status, error) {
        console.error('AJAX Error: ' + status + error);
      },
      success: function (response) {
        console.log(response);
        var states = response["states"];
        $("#state_id").empty();
        $("#state_id").append('<option>Select State</option>');
        for(var i=0; i< states.length; i++){
          $("#state_id").append('<option value="' + states[i]["id"] + '">' + states[i]["name"] + '</option>');
        }
      }
    });
  });
  $(document).on("change", "#state_id", function(){
    var state = $(this).val();
    $.ajax({
      url: "/users/edit",
      method: "GET",
      dataType: "json",
      data: {state: state},
      error: function (xhr, status, error) {
        console.error('AJAX Error: ' + status + error);
      },
      success: function (response) {
        console.log(response);
        var cities = response["cities"];
        $("#city_id").empty();
        $("#city_id").append('<option>Select City</option>');
        for(var i=0; i< cities.length; i++){
          $("#city_id").append('<option value="' + cities[i]["id"] + '">' + cities[i]["name"] + '</option>');
        }
      }
    });
  });
</script>